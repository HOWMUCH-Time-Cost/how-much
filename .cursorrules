# Cursor Rules for how-much project

## Git Commit Behavior
- On every code change, automatically commit to the current branch
- **Exception**: Do NOT auto-commit if the current branch is `main` or `master`
- Use descriptive commit messages that explain what was changed
- Commit messages should be in present tense (e.g., "Add feature X" not "Added feature X")

## Commit Message Format
- Start with a verb: Add, Fix, Update, Refactor, Remove, etc.
- Be concise but descriptive
- Include relevant context when helpful

## Examples
- "Add currency formatting for BRL locale"
- "Fix number parsing for European format"
- "Update popup UI with shadcn components"
- "Refactor content script for better performance"

## When NOT to commit
- When on `main` branch (requires manual review)
- When only documentation changes (unless explicitly requested)
- When changes are incomplete or broken

## Git Tagging on Main Branch
- When pushing to `main` branch, automatically create and push a tag
- Tag format: `beta-v{month}{day}{hour}{minute}` (e.g., `beta-v11241530` for November 24th at 15:30, `beta-v12050945` for December 5th at 09:45)
- Month should be a number without leading zeros (1-12)
- Day should be a two-digit number with leading zero if needed (01-31)
- Hour should be a two-digit number in 24-hour format (00-23)
- Minute should be a two-digit number (00-59)
- Examples: 
  - November 24th at 3:30 PM → `beta-v11241530`
  - December 5th at 9:45 AM → `beta-v12050945`
  - January 3rd at 11:05 PM → `beta-v01032305`
- Push the tag to remote along with the commits

## Project Rules

Additional project-specific rules are organized in separate files in `.cursor/rules/`:
- **Design System**: See `.cursor/rules/design-system.mdc` for shadcn/ui design system guidelines
- **Currency Punctuation**: See `.cursor/rules/currency-punctuation.mdc` for detailed rules on handling different number formats when parsing prices

## Change Tracking

- **Changes Log**: See `.changes-log.md` to track all changes with commit information
- Before pushing, review `.changes-log.md` to organize and split commits properly
- Update `.changes-log.md` immediately after making any changes

## React Extension UI Build Process

The extension popup UI is built with React and must be rebuilt when React source files change.

### Keeping the Extension UI Updated

- **When to rebuild**: After making any changes to files in `src/` directory (especially `src/App.jsx`, `src/main.jsx`, or any components)
- **Build command**: Run `npm run build` to rebuild the extension
- **Build output**: The build process generates:
  - `popup.js` - Bundled React application
  - `popup.css` - Compiled Tailwind CSS styles
  - `popup.html` - Updated HTML with correct script references

### Build Process

1. `popup.html` should reference the React entry point: `<script type="module" src="/src/main.jsx"></script>`
2. Run `npm run build` - Vite will:
   - Bundle the React app from `src/main.jsx`
   - Compile Tailwind CSS
   - Update `popup.html` with references to the built files (`./popup.js` and `./popup.css`)
   - Output all files to the root directory (for extension compatibility)

### After Building

- Always reload the extension in the browser to see changes:
  1. Open `chrome://extensions/` or `edge://extensions/`
  2. Find the extension and click the reload button

### Important Notes

- **Don't edit `popup.js` directly** - it's a generated file and will be overwritten on build
- **Don't manually edit built files** - always make changes to source files in `src/` and rebuild
- The `popup.html` file gets automatically updated during build, but it starts with a reference to `/src/main.jsx`

